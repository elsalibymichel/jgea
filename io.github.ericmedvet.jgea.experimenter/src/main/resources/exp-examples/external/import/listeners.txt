$GENERAL_LISTENERS = [

  ea.l.console(
    functions = [
      ea.f.timestamp();
      ea.f.size(of = ea.f.genotype(of = ea.f.best()); format = "%3d");
      ea.f.quality(of = ea.f.best(); format = "%4.1f")
    ]
  );

  ea.listener.allCsv(
    path = "../results/{name}/{startTime}/last-generations.csv";
    runFunctions = [
      ea.f.runKey(key = "run.problem.simulation.environment");
      ea.f.runKey(key = "run.solver.mapper")
    ];
    individualFunctions = [
      ea.f.timestamp();
      f.toBase64(of = ea.f.genotype());
      ea.f.quality()
    ];
    onlyLast = true
  );

  ea.l.bestCsv(
    path = "../results/{name}/{startTime}/last-generations-bests.csv";
    runFunctions = [
      ea.f.runKey(key = "run.problem.simulation.environment");
      ea.f.runKey(key = "run.solver.mapper")
    ];
    functions = [
      ea.f.timestamp();
      f.toBase64(of = ea.f.genotype(of = ea.f.best()));
      ea.f.quality(of = ea.f.best())
    ];
    onlyLast = true
  );

  ea.l.savePlotAndCsvForExp(
    path = "../results/{name}/{startTime}/best-q.svg";
    plot = ea.plot.multi.quality();
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForExp(
    deferred = true;
    path = "../results/{name}/{startTime}/best-vs-self.svg";
    plot = ea.plot.multi.xyExp(y = f.composition(of = f.composition(of = ea.f.best(); then = $VS_SELF); then = $QUALITY_F1));
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForExp(
    deferred = true;
    path = "../results/{name}/{startTime}/best-vs-opponent.svg";
    plot = ea.plot.multi.xyExp(y = f.composition(of = f.composition(of = ea.f.best(); then = $VS_OPPONENT); then = $QUALITY_F1));
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForExp(
    path = "../results/{name}/{startTime}/avg-q.svg";
    plot = ea.plot.multi.xyExp(y = f.avg(of = f.each(mapF = ea.f.quality(); of = ea.f.all())));
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForExp(
    deferred = true;
    path = "../results/{name}/{startTime}/avg-vs-self.svg";
    plot = ea.plot.multi.xyExp(y = f.avg(of = f.each(mapF = f.composition(of = f.composition(then = $VS_SELF); then = $QUALITY_F1); of = ea.f.all())));
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForExp(
    deferred = true;
    path = "../results/{name}/{startTime}/avg-vs-opponent.svg";
    plot = ea.plot.multi.xyExp(y = f.avg(of = f.each(mapF = f.composition(of = f.composition(then = $VS_OPPONENT); then = $QUALITY_F1); of = ea.f.all())));
    overwrite = true;
    type = svg
  );

  ea.l.savePlotAndCsvForRun(
    path = "../results/{name}/{startTime}/archive-{run.problem.name}-{run.solver.name}-{run.randomGenerator.seed:%03d}.svg";
    plot = ea.plot.single.me();
    condition = predicate.matches(f = ea.f.runKey(key = "run.solver.name"); regex = ".*-me-.*");
    type = svg
  )

]

$PONG_LISTENERS = [
  ea.l.saveForRun(
    of = ea.acc.lastBest();
    processor = ea.f.toVideo(
      video = ea.misc.toVideo(drawer = ds.d.pong());
      of = $VS_SELF
    );
    path = "../results/{name}/{startTime}/best-vs-self-{run.solver.name}-{run.randomGenerator.seed:%04d}";
    condition = $VIDEO
  )
]

$SUMO_LISTENERS =[
  ea.l.saveForRun(
    of = ea.acc.lastBest();
    processor = f.composition(
      of = f.pairerFirst(of = ea.f.solution(); second = m.supplier(of = s.a.dummyBox()));
      then = sim.biTaskVideoBuilder(
        drawer = sim.drawer(framer = sim.staticFramer(minX = 4; maxX = 36; minY = 3; maxY = 24); actions = true);
        task = $SIMULATION
      )
    );
    path = "../results/{name}/{startTime}/best-vs-box-{run.solver.name}-{run.randomGenerator.seed:%04d}.mp4";
    condition = $VIDEO
  )
]